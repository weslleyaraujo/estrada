/** estrada -v0.1.1
* Copyright (c) 2015 Weslley Araujo <weslleyaraujo20@gmail.com>
* Licensed MIT
*/

!function(a,b){"function"==typeof define&&define.amd?define([],b):"object"==typeof exports?module.exports=b():a.Estrada=b()}(this,function(){"use strict";function a(){this.routes={},this._bind(),this._setup()}return a.prototype._bind=function(){"undefined"!=typeof window&&window.addEventListener("hashchange",this._onHasChange.bind(this),!1)},a.prototype._onHasChange=function(){this._setup(),this.start()},a.prototype.register=function(a){return a=a||{},a.routes=a.routes||{},Object.keys(a.routes).forEach(function(b,c){this.routes[b]={callback:this._callbackHandler(a[a.routes[b]]),match:this._createMatch(b)}}.bind(this)),this},a.prototype._callbackHandler=function(a){return"function"==typeof a?a:function(){console.log("[Estrada]: callback not found for this route!")}},a.prototype._getParameters=function(a){var b=[],c=this.options.hash.split("/");return a=this._prepareRoute(a).split("/"),a.forEach(function(a,d){a.match(/:/)&&b.push(c[d])}),b},a.prototype._createMatch=function(a){return a=this._prepareRoute(a),"/"===a?new RegExp(/^\s*$/):a.split("/").map(function(a){return a.match(/:/)?"[^\\/]*":a}).join("\\/")+"$"},a.prototype._prepareRoute=function(a){return"/"===a.charAt(0)?a:"/"+a},a.prototype.start=function(){var a;Object.keys(this.routes).forEach(function(b){a=this.routes[b],this._isMatch(this.options.hash,a.match)&&a.callback.apply(this,this._getParameters(b))}.bind(this))},a.prototype._isMatch=function(a,b){return!!a.match(b)},a.prototype._setup=function(){var a=document.location.hash.replace(/#/,"");return this.options={hash:a},this},a.prototype.navigate=function(a){a=a||"",document.location.hash=a},new a});